<?xml version="1.0"?>
<launch>
    <!-- Runs the floam pipeline: lidar and odom nodes -->
    <arg name="isScanning" default="true" />

    <!-- common args -->
    <arg name="points_topic" default="/lidar_point_cloud/filtered" />
    <!-- new frame id for edge and surface pointclouds -->
    <arg name="frame_id" default="floam_base_link" />
    <!-- your datas lidar frame_id, the same frame_id as your points topic -->
    <arg name="lidar_frame_id" default="laser" />
    <!-- floam's new frame_id to not interfere with any existing tf tree -->
    <!-- always starts with `floam_` and then your lidars frame_id -->
    <arg name="floam_frame_id" default="floam_$(arg lidar_frame_id)" />

    <arg name="max_distance" default="20" />
    <arg name="min_distance" default="0.0" />
    <!-- default to true, timestamps will always match if using floam lidar nodes -->
    <!-- will only be false if user chooses to implement their own lidar processing nodes -->
    <arg name="use_exact_sync" default="true" />
    <arg name="queue_size" default="10" />
    
    <arg name="edge_threshold" default="0.05" />

    <!-- scanning lidar args -->
    <arg name="scan_lines" default="16" />
    <arg name="skip_points" default="1" />
    <arg name="search_k" default="10" />
    <arg name="search_radius" default="0.25" />
    <arg name="period" default="0.2" />

    <!-- odom args -->
    <arg name="odom_parent_frame_id" default="odom" />
    <arg name="edge_cloud_topic" default="/floam_lidar_node/points_edge" />
    <arg name="surface_cloud_topic" default="/floam_lidar_node/points_surface" />
    <arg name="map_resolution" default="0.4" />

    <!-- Node Manager Arguments -->
    <arg name="node_name_base" default="floam" />
    <arg name="manager_name" default="$(arg node_name_base)_manager" />
    <arg name="global_manager_name" default="/$(arg manager_name)" />
    <!-- set `new_manager` to false if you have already launched a nodelet manager elsewhere -->
    <!-- if false, be sure you set the `manager_name` to your nodelet manager's name -->
    <arg name="new_manager" default="true" />
    
    <!-- floam lidar node, launches the nodelet manager -->
    <include file="$(find floam)/launch/floam_scanning_lidar.launch" pass_all_args="true" if="$(arg isScanning)" />

    <!-- floam odom node -->
    <include file="$(find floam)/launch/floam_odom.launch" pass_all_args="true" >
      <arg name="odom_topic" value="/floam_odom"/>
    </include>

    <include file="$(find odom_3dof)/launch/odom_3dof.launch"/>
</launch>